/home/dezhang/.local/lib/python3.10/site-packages/numba/np/ufunc/parallel.py:371: NumbaWarning: [1mThe TBB threading layer requires TBB version 2021 update 6 or later i.e., TBB_INTERFACE_VERSION >= 12060. Found TBB_INTERFACE_VERSION = 12050. The TBB threading layer is disabled.[0m
  warnings.warn(problem)
2025-08-07 20:09:31.020493: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1754568571.033157  104960 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1754568571.037096  104960 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1754568571.048385  104960 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1754568571.048401  104960 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1754568571.048404  104960 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1754568571.048407  104960 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-08-07 20:09:31.051562: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
/home/dezhang/.local/lib/python3.10/site-packages/huggingface_hub/file_download.py:1142: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Namespace(test_num=100, method='prc', model_id='stabilityai/stable-diffusion-2-1-base', dataset_id='Gustavosta/Stable-Diffusion-Prompts', inf_steps=50, nowm=0, fpr=0.1, prc_t=3, attack='white_noise', eps=6.0, device='cuda:1', message_length=2000, inversion='prompt')
Saving original images to ./results/prc_num_100_steps_50_fpr_0.1_nowm_0_eps_6.0_attack_white_noise_mess_len_2000_inversion_prompt_model_stabilityai_stable-diffusion-2-1-base/original_images
Loading pipeline components...:   0%|          | 0/6 [00:00<?, ?it/s]Loading pipeline components...:  17%|â–ˆâ–‹        | 1/6 [00:00<00:01,  3.06it/s]Loading pipeline components...:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  6.60it/s]Loading pipeline components...: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:00<00:00,  8.62it/s]
  0%|          | 0/100 [00:00<?, ?it/s]/home/dezhang/.local/lib/python3.10/site-packages/diffusers/pipelines/stable_diffusion/pipeline_stable_diffusion.py:237: FutureWarning: `_encode_prompt()` is deprecated and it will be removed in a future version. Use `encode_prompt()` instead. Also, be aware that the output format changed from a concatenated tensor to a tuple.
  deprecate("_encode_prompt()", "1.0.0", deprecation_message, standard_warn=False)

  0%|          | 0/50 [00:00<?, ?it/s][A
  2%|â–         | 1/50 [00:00<00:12,  4.07it/s][A
  4%|â–         | 2/50 [00:00<00:07,  6.12it/s][A
  6%|â–Œ         | 3/50 [00:00<00:06,  7.30it/s][A
  8%|â–Š         | 4/50 [00:00<00:05,  8.02it/s][A
 10%|â–ˆ         | 5/50 [00:00<00:05,  8.48it/s][A
 12%|â–ˆâ–        | 6/50 [00:00<00:05,  8.80it/s][A
 14%|â–ˆâ–        | 7/50 [00:00<00:04,  9.00it/s][A
 16%|â–ˆâ–Œ        | 8/50 [00:00<00:04,  9.13it/s][A
 18%|â–ˆâ–Š        | 9/50 [00:01<00:04,  9.22it/s][A
 20%|â–ˆâ–ˆ        | 10/50 [00:01<00:04,  9.28it/s][A
 22%|â–ˆâ–ˆâ–       | 11/50 [00:01<00:04,  9.33it/s][A
 24%|â–ˆâ–ˆâ–       | 12/50 [00:01<00:04,  9.36it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 13/50 [00:01<00:03,  9.38it/s][A
 28%|â–ˆâ–ˆâ–Š       | 14/50 [00:01<00:03,  9.39it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 15/50 [00:01<00:03,  9.40it/s][A
 32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [00:01<00:03,  9.41it/s][A
 34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [00:01<00:03,  9.41it/s][A
 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [00:02<00:03,  9.41it/s][A
 38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [00:02<00:03,  9.41it/s][A
 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [00:02<00:03,  9.41it/s][A
 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [00:02<00:03,  9.41it/s][A
 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [00:02<00:02,  9.41it/s][A
 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [00:02<00:02,  9.41it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [00:02<00:02,  9.41it/s][A
 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [00:02<00:02,  9.41it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [00:02<00:02,  9.41it/s][A
 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [00:03<00:02,  9.41it/s][A
 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [00:03<00:02,  9.41it/s][A
 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [00:03<00:02,  9.41it/s][A
 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [00:03<00:02,  9.40it/s][A
 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 31/50 [00:03<00:02,  9.40it/s][A
 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 32/50 [00:03<00:01,  9.40it/s][A
 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [00:03<00:01,  9.40it/s][A
 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 34/50 [00:03<00:01,  9.39it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 35/50 [00:03<00:01,  9.39it/s][A
 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 36/50 [00:03<00:01,  9.39it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 37/50 [00:04<00:01,  9.39it/s][A
 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 38/50 [00:04<00:01,  9.39it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 39/50 [00:04<00:01,  9.39it/s][A
 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 40/50 [00:04<00:01,  9.39it/s][A
 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 41/50 [00:04<00:00,  9.39it/s][A
 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 42/50 [00:04<00:00,  9.39it/s][A
 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 43/50 [00:04<00:00,  9.39it/s][A
 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 44/50 [00:04<00:00,  9.39it/s][A
 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 45/50 [00:04<00:00,  9.39it/s][A
 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 46/50 [00:05<00:00,  9.39it/s][A
 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 47/50 [00:05<00:00,  9.39it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 48/50 [00:05<00:00,  9.38it/s][A
 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 49/50 [00:05<00:00,  9.39it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 50/50 [00:05<00:00,  9.39it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 50/50 [00:05<00:00,  9.17it/s]
/home/dezhang/.local/lib/python3.10/site-packages/diffusers/pipelines/stable_diffusion/pipeline_stable_diffusion.py:430: FutureWarning: The decode_latents method is deprecated and will be removed in 1.0.0. Please use VaeImageProcessor.postprocess(...) instead
  deprecate("decode_latents", "1.0.0", deprecation_message, standard_warn=False)

  0%|          | 0/49 [00:00<?, ?it/s][A
  2%|â–         | 1/49 [00:00<00:05,  9.53it/s][A
  4%|â–         | 2/49 [00:00<00:04,  9.47it/s][A
  6%|â–Œ         | 3/49 [00:00<00:04,  9.44it/s][A
  8%|â–Š         | 4/49 [00:00<00:04,  9.43it/s][A
 10%|â–ˆ         | 5/49 [00:00<00:04,  9.42it/s][A
 12%|â–ˆâ–        | 6/49 [00:00<00:04,  9.41it/s][A
 14%|â–ˆâ–        | 7/49 [00:00<00:04,  9.40it/s][A
 16%|â–ˆâ–‹        | 8/49 [00:00<00:04,  9.40it/s][A
 18%|â–ˆâ–Š        | 9/49 [00:00<00:04,  9.40it/s][A
 20%|â–ˆâ–ˆ        | 10/49 [00:01<00:04,  9.40it/s][A
 22%|â–ˆâ–ˆâ–       | 11/49 [00:01<00:04,  9.40it/s][A
 24%|â–ˆâ–ˆâ–       | 12/49 [00:01<00:03,  9.40it/s][A
 27%|â–ˆâ–ˆâ–‹       | 13/49 [00:01<00:03,  9.39it/s][A
 29%|â–ˆâ–ˆâ–Š       | 14/49 [00:01<00:03,  9.39it/s][A
 31%|â–ˆâ–ˆâ–ˆ       | 15/49 [00:01<00:03,  9.39it/s][A
 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 16/49 [00:01<00:03,  9.38it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 17/49 [00:01<00:03,  9.38it/s][A
 37%|â–ˆâ–ˆâ–ˆâ–‹      | 18/49 [00:01<00:03,  9.38it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 19/49 [00:02<00:03,  9.38it/s][A
 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/49 [00:02<00:03,  9.38it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 21/49 [00:02<00:02,  9.38it/s][A
 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/49 [00:02<00:02,  9.37it/s][A
 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 23/49 [00:02<00:02,  9.38it/s][A
 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 24/49 [00:02<00:02,  9.38it/s][A
 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/49 [00:02<00:02,  9.37it/s][A
 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 26/49 [00:02<00:02,  9.38it/s][A
 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 27/49 [00:02<00:02,  9.37it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 28/49 [00:02<00:02,  9.38it/s][A
 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 29/49 [00:03<00:02,  9.38it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/49 [00:03<00:02,  9.38it/s][A
 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 31/49 [00:03<00:01,  9.38it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 32/49 [00:03<00:01,  9.38it/s][A
 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 33/49 [00:03<00:01,  9.38it/s][A
 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 34/49 [00:03<00:01,  9.38it/s][A
 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 35/49 [00:03<00:01,  9.38it/s][A
 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 36/49 [00:03<00:01,  9.38it/s][A
 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 37/49 [00:03<00:01,  9.37it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 38/49 [00:04<00:01,  9.37it/s][A
 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 39/49 [00:04<00:01,  9.38it/s][A
 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 40/49 [00:04<00:00,  9.37it/s][A
 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 41/49 [00:04<00:00,  9.38it/s][A
 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 42/49 [00:04<00:00,  9.38it/s][A
 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 43/49 [00:04<00:00,  9.38it/s][A
 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 44/49 [00:04<00:00,  9.39it/s][A
 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 45/49 [00:04<00:00,  9.39it/s][A
 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 46/49 [00:04<00:00,  9.39it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 47/49 [00:05<00:00,  9.40it/s][A
 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 48/49 [00:05<00:00,  9.39it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 49/49 [00:05<00:00,  9.58it/s]
  0%|          | 0/100 [00:11<?, ?it/s]
Traceback (most recent call last):
  File "/home/dezhang/watermark_removal/SD15_21/encode_exact_invert_remove.py", line 377, in <module>
    reversed_latents = inverted_latents[-(start_step + 1)][None]
IndexError: index -51 is out of bounds for dimension 0 with size 48
