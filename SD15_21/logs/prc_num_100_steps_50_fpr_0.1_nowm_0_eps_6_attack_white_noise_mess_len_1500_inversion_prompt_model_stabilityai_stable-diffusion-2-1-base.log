/home/dezhang/.local/lib/python3.10/site-packages/numba/np/ufunc/parallel.py:371: NumbaWarning: [1mThe TBB threading layer requires TBB version 2021 update 6 or later i.e., TBB_INTERFACE_VERSION >= 12060. Found TBB_INTERFACE_VERSION = 12050. The TBB threading layer is disabled.[0m
  warnings.warn(problem)
2025-08-07 22:47:45.688688: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1754578065.701328  108405 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1754578065.705146  108405 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1754578065.716065  108405 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1754578065.716083  108405 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1754578065.716086  108405 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1754578065.716089  108405 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-08-07 22:47:45.719186: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
/home/dezhang/.local/lib/python3.10/site-packages/huggingface_hub/file_download.py:1142: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Namespace(test_num=100, method='prc', model_id='stabilityai/stable-diffusion-2-1-base', dataset_id='Gustavosta/Stable-Diffusion-Prompts', inf_steps=50, nowm=0, fpr=0.1, prc_t=3, attack='white_noise', eps=6.0, device='cuda:1', message_length=1500, inversion='prompt')
Saving original images to ./results/prc_num_100_steps_50_fpr_0.1_nowm_0_eps_6.0_attack_white_noise_mess_len_1500_inversion_prompt/original_images
Loading pipeline components...:   0%|          | 0/6 [00:00<?, ?it/s]Loading pipeline components...:  33%|███▎      | 2/6 [00:00<00:00,  6.00it/s]Loading pipeline components...:  50%|█████     | 3/6 [00:00<00:00,  4.67it/s]Loading pipeline components...: 100%|██████████| 6/6 [00:00<00:00,  8.63it/s]
  0%|          | 0/100 [00:00<?, ?it/s]/home/dezhang/.local/lib/python3.10/site-packages/diffusers/pipelines/stable_diffusion/pipeline_stable_diffusion.py:237: FutureWarning: `_encode_prompt()` is deprecated and it will be removed in a future version. Use `encode_prompt()` instead. Also, be aware that the output format changed from a concatenated tensor to a tuple.
  deprecate("_encode_prompt()", "1.0.0", deprecation_message, standard_warn=False)

  0%|          | 0/50 [00:00<?, ?it/s][A
  2%|▏         | 1/50 [00:00<00:23,  2.07it/s][A
  4%|▍         | 2/50 [00:00<00:15,  3.01it/s][A
  6%|▌         | 3/50 [00:00<00:13,  3.51it/s][A
  8%|▊         | 4/50 [00:01<00:12,  3.81it/s][A
 10%|█         | 5/50 [00:01<00:11,  3.94it/s][A
 12%|█▏        | 6/50 [00:01<00:10,  4.06it/s][A
 14%|█▍        | 7/50 [00:01<00:10,  4.16it/s][A
 16%|█▌        | 8/50 [00:02<00:09,  4.23it/s][A
 18%|█▊        | 9/50 [00:02<00:09,  4.27it/s][A
 20%|██        | 10/50 [00:02<00:09,  4.31it/s][A
 22%|██▏       | 11/50 [00:02<00:08,  4.34it/s][A
 24%|██▍       | 12/50 [00:03<00:08,  4.35it/s][A
 26%|██▌       | 13/50 [00:03<00:08,  4.37it/s][A
 28%|██▊       | 14/50 [00:03<00:08,  4.37it/s][A
 30%|███       | 15/50 [00:03<00:07,  4.40it/s][A
 32%|███▏      | 16/50 [00:03<00:07,  4.42it/s][A
 34%|███▍      | 17/50 [00:04<00:07,  4.43it/s][A
 36%|███▌      | 18/50 [00:04<00:07,  4.44it/s][A
 38%|███▊      | 19/50 [00:04<00:06,  4.44it/s][A
 40%|████      | 20/50 [00:04<00:06,  4.45it/s][A
 42%|████▏     | 21/50 [00:05<00:06,  4.38it/s][A
 44%|████▍     | 22/50 [00:05<00:06,  4.36it/s][A
 46%|████▌     | 23/50 [00:05<00:06,  4.39it/s][A
 48%|████▊     | 24/50 [00:05<00:05,  4.41it/s][A
 50%|█████     | 25/50 [00:05<00:05,  4.41it/s][A
 52%|█████▏    | 26/50 [00:06<00:05,  4.43it/s][A
 54%|█████▍    | 27/50 [00:06<00:05,  4.44it/s][A
 56%|█████▌    | 28/50 [00:06<00:04,  4.45it/s][A
 58%|█████▊    | 29/50 [00:06<00:04,  4.45it/s][A
 60%|██████    | 30/50 [00:07<00:04,  4.46it/s][A
 62%|██████▏   | 31/50 [00:07<00:04,  4.46it/s][A
 64%|██████▍   | 32/50 [00:07<00:04,  4.46it/s][A
 66%|██████▌   | 33/50 [00:07<00:03,  4.46it/s][A
 68%|██████▊   | 34/50 [00:07<00:03,  4.45it/s][A
 70%|███████   | 35/50 [00:08<00:03,  4.46it/s][A
 72%|███████▏  | 36/50 [00:08<00:03,  4.44it/s][A
 74%|███████▍  | 37/50 [00:08<00:02,  4.44it/s][A
 76%|███████▌  | 38/50 [00:08<00:02,  4.45it/s][A
 78%|███████▊  | 39/50 [00:09<00:02,  4.45it/s][A
 80%|████████  | 40/50 [00:09<00:02,  4.45it/s][A
 82%|████████▏ | 41/50 [00:09<00:02,  4.44it/s][A
 84%|████████▍ | 42/50 [00:09<00:01,  4.44it/s][A
 86%|████████▌ | 43/50 [00:09<00:01,  4.44it/s][A
 88%|████████▊ | 44/50 [00:10<00:01,  4.43it/s][A
 90%|█████████ | 45/50 [00:10<00:01,  4.44it/s][A
 92%|█████████▏| 46/50 [00:10<00:00,  4.45it/s][A
 94%|█████████▍| 47/50 [00:10<00:00,  4.43it/s][A
 96%|█████████▌| 48/50 [00:11<00:00,  4.44it/s][A
 98%|█████████▊| 49/50 [00:11<00:00,  4.45it/s][A
100%|██████████| 50/50 [00:11<00:00,  4.45it/s][A100%|██████████| 50/50 [00:11<00:00,  4.32it/s]
/home/dezhang/.local/lib/python3.10/site-packages/diffusers/pipelines/stable_diffusion/pipeline_stable_diffusion.py:430: FutureWarning: The decode_latents method is deprecated and will be removed in 1.0.0. Please use VaeImageProcessor.postprocess(...) instead
  deprecate("decode_latents", "1.0.0", deprecation_message, standard_warn=False)

  0%|          | 0/49 [00:00<?, ?it/s][A
  2%|▏         | 1/49 [00:00<00:10,  4.44it/s][A
  4%|▍         | 2/49 [00:00<00:10,  4.43it/s][A
  6%|▌         | 3/49 [00:00<00:10,  4.44it/s][A
  8%|▊         | 4/49 [00:00<00:10,  4.42it/s][A
 10%|█         | 5/49 [00:01<00:09,  4.43it/s][A
 12%|█▏        | 6/49 [00:01<00:09,  4.44it/s][A
 14%|█▍        | 7/49 [00:01<00:09,  4.43it/s][A
 16%|█▋        | 8/49 [00:01<00:09,  4.43it/s][A
 18%|█▊        | 9/49 [00:02<00:09,  4.44it/s][A
 20%|██        | 10/49 [00:02<00:08,  4.43it/s][A
 22%|██▏       | 11/49 [00:02<00:08,  4.44it/s][A
 24%|██▍       | 12/49 [00:02<00:08,  4.44it/s][A
 27%|██▋       | 13/49 [00:02<00:08,  4.45it/s][A
 29%|██▊       | 14/49 [00:03<00:07,  4.45it/s][A
 31%|███       | 15/49 [00:03<00:07,  4.41it/s][A
 33%|███▎      | 16/49 [00:03<00:07,  4.40it/s][A
 35%|███▍      | 17/49 [00:03<00:07,  4.39it/s][A
 37%|███▋      | 18/49 [00:04<00:07,  4.37it/s][A
 39%|███▉      | 19/49 [00:04<00:06,  4.37it/s][A
 41%|████      | 20/49 [00:04<00:06,  4.37it/s][A
 43%|████▎     | 21/49 [00:04<00:06,  4.38it/s][A
 45%|████▍     | 22/49 [00:04<00:06,  4.38it/s][A
 47%|████▋     | 23/49 [00:05<00:05,  4.37it/s][A
 49%|████▉     | 24/49 [00:05<00:05,  4.37it/s][A
 51%|█████     | 25/49 [00:05<00:05,  4.39it/s][A
 53%|█████▎    | 26/49 [00:05<00:05,  4.39it/s][A
 55%|█████▌    | 27/49 [00:06<00:05,  4.38it/s][A
 57%|█████▋    | 28/49 [00:06<00:04,  4.38it/s][A
 59%|█████▉    | 29/49 [00:06<00:04,  4.36it/s][A
 61%|██████    | 30/49 [00:06<00:04,  4.37it/s][A
 63%|██████▎   | 31/49 [00:07<00:04,  4.37it/s][A
 65%|██████▌   | 32/49 [00:07<00:03,  4.35it/s][A
 67%|██████▋   | 33/49 [00:07<00:03,  4.32it/s][A
 69%|██████▉   | 34/49 [00:07<00:03,  4.33it/s][A
 71%|███████▏  | 35/49 [00:07<00:03,  4.34it/s][A
 73%|███████▎  | 36/49 [00:08<00:02,  4.36it/s][A
 76%|███████▌  | 37/49 [00:08<00:02,  4.35it/s][A
 78%|███████▊  | 38/49 [00:08<00:02,  4.36it/s][A
 80%|███████▉  | 39/49 [00:08<00:02,  4.36it/s][A
 82%|████████▏ | 40/49 [00:09<00:02,  4.32it/s][A
 84%|████████▎ | 41/49 [00:09<00:01,  4.32it/s][A
 86%|████████▌ | 42/49 [00:09<00:01,  4.34it/s][A
 88%|████████▊ | 43/49 [00:09<00:01,  4.36it/s][A
 90%|████████▉ | 44/49 [00:10<00:01,  4.37it/s][A
 92%|█████████▏| 45/49 [00:10<00:00,  4.37it/s][A
 94%|█████████▍| 46/49 [00:10<00:00,  4.36it/s][A
 96%|█████████▌| 47/49 [00:10<00:00,  4.37it/s][A
 98%|█████████▊| 48/49 [00:10<00:00,  4.35it/s][A100%|██████████| 49/49 [00:10<00:00,  4.47it/s]
tensor(3109.7223, device='cuda:1', dtype=torch.float64)
tensor(23.8534, device='cuda:1')

  0%|          | 0/50 [00:00<?, ?it/s][A
  2%|▏         | 1/50 [00:00<00:11,  4.38it/s][A
  4%|▍         | 2/50 [00:00<00:10,  4.38it/s][A
  6%|▌         | 3/50 [00:00<00:10,  4.41it/s][A
  8%|▊         | 4/50 [00:00<00:10,  4.41it/s][A
 10%|█         | 5/50 [00:01<00:10,  4.42it/s][A
 12%|█▏        | 6/50 [00:01<00:09,  4.44it/s][A
 14%|█▍        | 7/50 [00:01<00:09,  4.43it/s][A
 16%|█▌        | 8/50 [00:01<00:09,  4.44it/s][A
 18%|█▊        | 9/50 [00:02<00:09,  4.37it/s][A
 20%|██        | 10/50 [00:02<00:09,  4.35it/s][A
 22%|██▏       | 11/50 [00:02<00:08,  4.38it/s][A
 24%|██▍       | 12/50 [00:02<00:08,  4.39it/s][A
 26%|██▌       | 13/50 [00:02<00:08,  4.41it/s][A
 28%|██▊       | 14/50 [00:03<00:08,  4.42it/s][A
 30%|███       | 15/50 [00:03<00:07,  4.42it/s][A
 32%|███▏      | 16/50 [00:03<00:07,  4.43it/s][A
 34%|███▍      | 17/50 [00:03<00:07,  4.42it/s][A
 36%|███▌      | 18/50 [00:04<00:07,  4.43it/s][A
 38%|███▊      | 19/50 [00:04<00:06,  4.44it/s][A
 40%|████      | 20/50 [00:04<00:06,  4.42it/s][A
 42%|████▏     | 21/50 [00:04<00:06,  4.42it/s][A
 44%|████▍     | 22/50 [00:04<00:06,  4.43it/s][A
 46%|████▌     | 23/50 [00:05<00:06,  4.42it/s][A
 48%|████▊     | 24/50 [00:05<00:05,  4.43it/s][A
 50%|█████     | 25/50 [00:05<00:05,  4.42it/s][A
 52%|█████▏    | 26/50 [00:05<00:05,  4.41it/s][A
 54%|█████▍    | 27/50 [00:06<00:05,  4.43it/s][A
 56%|█████▌    | 28/50 [00:06<00:04,  4.41it/s][A
 58%|█████▊    | 29/50 [00:06<00:04,  4.43it/s][A
 60%|██████    | 30/50 [00:06<00:04,  4.43it/s][A
 62%|██████▏   | 31/50 [00:07<00:04,  4.42it/s][A
 64%|██████▍   | 32/50 [00:07<00:04,  4.43it/s][A
 66%|██████▌   | 33/50 [00:07<00:03,  4.42it/s][A
 68%|██████▊   | 34/50 [00:07<00:03,  4.41it/s][A
 70%|███████   | 35/50 [00:07<00:03,  4.42it/s][A
 72%|███████▏  | 36/50 [00:08<00:03,  4.43it/s][A
 74%|███████▍  | 37/50 [00:08<00:02,  4.42it/s][A
 76%|███████▌  | 38/50 [00:08<00:02,  4.43it/s][A
 78%|███████▊  | 39/50 [00:08<00:02,  4.42it/s][A
 80%|████████  | 40/50 [00:09<00:02,  4.43it/s][A
 82%|████████▏ | 41/50 [00:09<00:02,  4.42it/s][A
 84%|████████▍ | 42/50 [00:09<00:01,  4.41it/s][A
 86%|████████▌ | 43/50 [00:09<00:01,  4.42it/s][A
 88%|████████▊ | 44/50 [00:09<00:01,  4.41it/s][A
 90%|█████████ | 45/50 [00:10<00:01,  4.41it/s][A
 92%|█████████▏| 46/50 [00:10<00:00,  4.42it/s][A
 94%|█████████▍| 47/50 [00:10<00:00,  4.42it/s][A
 96%|█████████▌| 48/50 [00:10<00:00,  4.41it/s][A
 98%|█████████▊| 49/50 [00:11<00:00,  4.42it/s][A
100%|██████████| 50/50 [00:11<00:00,  4.42it/s][A100%|██████████| 50/50 [00:11<00:00,  4.42it/s]
  1%|          | 1/100 [01:46<2:56:01, 106.68s/it]/home/dezhang/.local/lib/python3.10/site-packages/diffusers/pipelines/stable_diffusion/pipeline_stable_diffusion.py:237: FutureWarning: `_encode_prompt()` is deprecated and it will be removed in a future version. Use `encode_prompt()` instead. Also, be aware that the output format changed from a concatenated tensor to a tuple.
  deprecate("_encode_prompt()", "1.0.0", deprecation_message, standard_warn=False)
Token indices sequence length is longer than the specified maximum sequence length for this model (112 > 77). Running this sequence through the model will result in indexing errors
The following part of your input was truncated because CLIP can only handle sequences up to 77 tokens: ['james gilleard, surrealism, airbrush, ilya kuvshinov, wlop, stanley artgerm, very coherent, art by takato yamamoto and james jean']
mse_0.06801526114739899_ssim_0.3320963796688899
000: Detection: True; Decoding: False; Combined: False

  0%|          | 0/50 [00:00<?, ?it/s][A
  2%|▏         | 1/50 [00:00<00:11,  4.40it/s][A
  4%|▍         | 2/50 [00:00<00:10,  4.39it/s][A
  6%|▌         | 3/50 [00:00<00:09,  5.17it/s][A
  8%|▊         | 4/50 [00:00<00:07,  6.28it/s][A
 10%|█         | 5/50 [00:00<00:06,  7.10it/s][A
 12%|█▏        | 6/50 [00:00<00:05,  7.71it/s][A
 14%|█▍        | 7/50 [00:01<00:05,  8.16it/s][A
 16%|█▌        | 8/50 [00:01<00:04,  8.55it/s][A
 18%|█▊        | 9/50 [00:01<00:04,  8.84it/s][A
 20%|██        | 10/50 [00:01<00:04,  9.04it/s][A
 22%|██▏       | 11/50 [00:01<00:04,  9.18it/s][A
 24%|██▍       | 12/50 [00:01<00:04,  9.28it/s][A
 26%|██▌       | 13/50 [00:01<00:03,  9.35it/s][A
 28%|██▊       | 14/50 [00:01<00:03,  9.40it/s][A
 30%|███       | 15/50 [00:01<00:03,  9.44it/s][A
 32%|███▏      | 16/50 [00:01<00:03,  9.46it/s][A
 34%|███▍      | 17/50 [00:02<00:03,  9.48it/s][A
 36%|███▌      | 18/50 [00:02<00:03,  9.50it/s][A
 38%|███▊      | 19/50 [00:02<00:03,  9.50it/s][A
 40%|████      | 20/50 [00:02<00:03,  9.51it/s][A
 42%|████▏     | 21/50 [00:02<00:03,  9.51it/s][A
 44%|████▍     | 22/50 [00:02<00:02,  9.52it/s][A
 46%|████▌     | 23/50 [00:02<00:02,  9.52it/s][A
 48%|████▊     | 24/50 [00:02<00:02,  9.52it/s][A
 50%|█████     | 25/50 [00:02<00:02,  9.52it/s][A
 52%|█████▏    | 26/50 [00:03<00:02,  9.53it/s][A
 54%|█████▍    | 27/50 [00:03<00:02,  9.53it/s][A