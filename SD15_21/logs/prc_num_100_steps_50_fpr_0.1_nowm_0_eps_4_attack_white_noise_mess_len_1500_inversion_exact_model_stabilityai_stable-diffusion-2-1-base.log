/home/dezhang/.local/lib/python3.10/site-packages/numba/np/ufunc/parallel.py:371: NumbaWarning: [1mThe TBB threading layer requires TBB version 2021 update 6 or later i.e., TBB_INTERFACE_VERSION >= 12060. Found TBB_INTERFACE_VERSION = 12050. The TBB threading layer is disabled.[0m
  warnings.warn(problem)
2025-08-07 22:47:28.303369: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1754578048.315499  107768 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1754578048.319183  107768 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1754578048.329767  107768 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1754578048.329784  107768 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1754578048.329787  107768 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1754578048.329790  107768 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-08-07 22:47:28.332743: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
/home/dezhang/.local/lib/python3.10/site-packages/huggingface_hub/file_download.py:1142: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Namespace(test_num=100, method='prc', model_id='stabilityai/stable-diffusion-2-1-base', dataset_id='Gustavosta/Stable-Diffusion-Prompts', inf_steps=50, nowm=0, fpr=0.1, prc_t=3, attack='white_noise', eps=4.0, device='cuda:1', message_length=1500, inversion='exact')
Saving original images to ./results/prc_num_100_steps_50_fpr_0.1_nowm_0_eps_4.0_attack_white_noise_mess_len_1500_inversion_exact/original_images
Loading pipeline components...:   0%|          | 0/6 [00:00<?, ?it/s]Loading pipeline components...:  17%|█▋        | 1/6 [00:00<00:02,  1.77it/s]Loading pipeline components...:  33%|███▎      | 2/6 [00:00<00:01,  3.38it/s]Loading pipeline components...: 100%|██████████| 6/6 [00:00<00:00,  8.01it/s]
  0%|          | 0/100 [00:00<?, ?it/s]/home/dezhang/.local/lib/python3.10/site-packages/diffusers/pipelines/stable_diffusion/pipeline_stable_diffusion.py:237: FutureWarning: `_encode_prompt()` is deprecated and it will be removed in a future version. Use `encode_prompt()` instead. Also, be aware that the output format changed from a concatenated tensor to a tuple.
  deprecate("_encode_prompt()", "1.0.0", deprecation_message, standard_warn=False)

  0%|          | 0/50 [00:00<?, ?it/s][A
  2%|▏         | 1/50 [00:00<00:17,  2.78it/s][A
  4%|▍         | 2/50 [00:00<00:10,  4.64it/s][A
  6%|▌         | 3/50 [00:00<00:07,  5.93it/s][A
  8%|▊         | 4/50 [00:00<00:06,  6.74it/s][A
 10%|█         | 5/50 [00:00<00:06,  7.33it/s][A
 12%|█▏        | 6/50 [00:00<00:05,  7.71it/s][A
 14%|█▍        | 7/50 [00:01<00:05,  7.98it/s][A
 16%|█▌        | 8/50 [00:01<00:05,  8.30it/s][A
 18%|█▊        | 9/50 [00:01<00:04,  8.36it/s][A
 20%|██        | 10/50 [00:01<00:04,  8.46it/s][A
 22%|██▏       | 11/50 [00:01<00:04,  8.63it/s][A
 24%|██▍       | 12/50 [00:01<00:04,  8.85it/s][A
 26%|██▌       | 13/50 [00:01<00:04,  8.99it/s][A
 28%|██▊       | 14/50 [00:01<00:03,  9.06it/s][A
 30%|███       | 15/50 [00:01<00:03,  9.14it/s][A
 32%|███▏      | 16/50 [00:02<00:03,  9.05it/s][A
 34%|███▍      | 17/50 [00:02<00:03,  9.01it/s][A
 36%|███▌      | 18/50 [00:02<00:03,  9.01it/s][A
 38%|███▊      | 19/50 [00:02<00:03,  8.86it/s][A
 40%|████      | 20/50 [00:02<00:03,  8.76it/s][A
 42%|████▏     | 21/50 [00:02<00:03,  8.74it/s][A
 44%|████▍     | 22/50 [00:02<00:03,  8.89it/s][A
 46%|████▌     | 23/50 [00:02<00:02,  9.10it/s][A
 48%|████▊     | 24/50 [00:02<00:02,  9.25it/s][A
 50%|█████     | 25/50 [00:03<00:02,  9.36it/s][A
 52%|█████▏    | 26/50 [00:03<00:02,  9.44it/s][A
 54%|█████▍    | 27/50 [00:03<00:02,  9.49it/s][A
 56%|█████▌    | 28/50 [00:03<00:02,  9.53it/s][A
 58%|█████▊    | 29/50 [00:03<00:02,  9.56it/s][A
 60%|██████    | 30/50 [00:03<00:02,  9.58it/s][A
 62%|██████▏   | 31/50 [00:03<00:01,  9.59it/s][A
 64%|██████▍   | 32/50 [00:03<00:01,  9.60it/s][A
 66%|██████▌   | 33/50 [00:03<00:01,  9.60it/s][A
 68%|██████▊   | 34/50 [00:03<00:01,  9.61it/s][A
 70%|███████   | 35/50 [00:04<00:01,  9.61it/s][A
 72%|███████▏  | 36/50 [00:04<00:01,  9.62it/s][A
 74%|███████▍  | 37/50 [00:04<00:01,  9.61it/s][A
 76%|███████▌  | 38/50 [00:04<00:01,  9.60it/s][A
 78%|███████▊  | 39/50 [00:04<00:01,  9.50it/s][A
 80%|████████  | 40/50 [00:04<00:01,  9.50it/s][A
 82%|████████▏ | 41/50 [00:04<00:00,  9.53it/s][A
 84%|████████▍ | 42/50 [00:04<00:00,  9.56it/s][A
 86%|████████▌ | 43/50 [00:04<00:00,  9.57it/s][A
 88%|████████▊ | 44/50 [00:05<00:00,  9.58it/s][A
 90%|█████████ | 45/50 [00:05<00:00,  9.59it/s][A
 92%|█████████▏| 46/50 [00:05<00:00,  9.59it/s][A
 94%|█████████▍| 47/50 [00:05<00:00,  9.60it/s][A
 96%|█████████▌| 48/50 [00:05<00:00,  9.60it/s][A
 98%|█████████▊| 49/50 [00:05<00:00,  9.60it/s][A
100%|██████████| 50/50 [00:05<00:00,  9.61it/s][A100%|██████████| 50/50 [00:05<00:00,  8.86it/s]
/home/dezhang/.local/lib/python3.10/site-packages/diffusers/pipelines/stable_diffusion/pipeline_stable_diffusion.py:430: FutureWarning: The decode_latents method is deprecated and will be removed in 1.0.0. Please use VaeImageProcessor.postprocess(...) instead
  deprecate("decode_latents", "1.0.0", deprecation_message, standard_warn=False)
tensor(0., device='cuda:1', dtype=torch.float64)
tensor(4.1135, device='cuda:1', dtype=torch.float64)

  0%|          | 0/50 [00:00<?, ?it/s][A
  2%|▏         | 1/50 [00:00<00:05,  9.75it/s][A
  4%|▍         | 2/50 [00:00<00:04,  9.66it/s][A
  6%|▌         | 3/50 [00:00<00:04,  9.65it/s][A
  8%|▊         | 4/50 [00:00<00:04,  9.64it/s][A
 10%|█         | 5/50 [00:00<00:04,  9.64it/s][A
 12%|█▏        | 6/50 [00:00<00:04,  9.63it/s][A
 14%|█▍        | 7/50 [00:00<00:04,  9.62it/s][A
 16%|█▌        | 8/50 [00:00<00:04,  9.62it/s][A
 18%|█▊        | 9/50 [00:00<00:04,  9.62it/s][A
 20%|██        | 10/50 [00:01<00:04,  9.61it/s][A
 22%|██▏       | 11/50 [00:01<00:04,  9.62it/s][A
 24%|██▍       | 12/50 [00:01<00:03,  9.61it/s][A
 26%|██▌       | 13/50 [00:01<00:03,  9.61it/s][A
 28%|██▊       | 14/50 [00:01<00:03,  9.61it/s][A
 30%|███       | 15/50 [00:01<00:03,  9.61it/s][A
 32%|███▏      | 16/50 [00:01<00:03,  9.61it/s][A
 34%|███▍      | 17/50 [00:01<00:03,  9.60it/s][A
 36%|███▌      | 18/50 [00:01<00:03,  9.60it/s][A
 38%|███▊      | 19/50 [00:01<00:03,  9.61it/s][A
 40%|████      | 20/50 [00:02<00:03,  9.63it/s][A
 42%|████▏     | 21/50 [00:02<00:03,  9.64it/s][A
 44%|████▍     | 22/50 [00:02<00:02,  9.64it/s][A
 46%|████▌     | 23/50 [00:02<00:02,  9.64it/s][A
 48%|████▊     | 24/50 [00:02<00:02,  9.64it/s][A
 50%|█████     | 25/50 [00:02<00:02,  9.65it/s][A
 52%|█████▏    | 26/50 [00:02<00:02,  9.65it/s][A
 54%|█████▍    | 27/50 [00:02<00:02,  9.65it/s][A
 56%|█████▌    | 28/50 [00:02<00:02,  9.65it/s][A
 58%|█████▊    | 29/50 [00:03<00:02,  9.65it/s][A
 60%|██████    | 30/50 [00:03<00:02,  9.65it/s][A
 62%|██████▏   | 31/50 [00:03<00:01,  9.65it/s][A
 64%|██████▍   | 32/50 [00:03<00:01,  9.64it/s][A
 66%|██████▌   | 33/50 [00:03<00:01,  9.64it/s][A
 68%|██████▊   | 34/50 [00:03<00:01,  9.64it/s][A
 70%|███████   | 35/50 [00:03<00:01,  9.64it/s][A
 72%|███████▏  | 36/50 [00:03<00:01,  9.65it/s][A
 74%|███████▍  | 37/50 [00:03<00:01,  9.65it/s][A
 76%|███████▌  | 38/50 [00:03<00:01,  9.64it/s][A
 78%|███████▊  | 39/50 [00:04<00:01,  9.65it/s][A
 80%|████████  | 40/50 [00:04<00:01,  9.65it/s][A
 82%|████████▏ | 41/50 [00:04<00:00,  9.65it/s][A
 84%|████████▍ | 42/50 [00:04<00:00,  9.65it/s][A
 86%|████████▌ | 43/50 [00:04<00:00,  9.65it/s][A
 88%|████████▊ | 44/50 [00:04<00:00,  9.65it/s][A
 90%|█████████ | 45/50 [00:04<00:00,  9.65it/s][A
 92%|█████████▏| 46/50 [00:04<00:00,  9.64it/s][A
 94%|█████████▍| 47/50 [00:04<00:00,  9.64it/s][A
 96%|█████████▌| 48/50 [00:04<00:00,  9.64it/s][A
 98%|█████████▊| 49/50 [00:05<00:00,  9.64it/s][A
100%|██████████| 50/50 [00:05<00:00,  9.65it/s][A100%|██████████| 50/50 [00:05<00:00,  9.64it/s]
  1%|          | 1/100 [01:20<2:13:08, 80.69s/it]/home/dezhang/.local/lib/python3.10/site-packages/diffusers/pipelines/stable_diffusion/pipeline_stable_diffusion.py:237: FutureWarning: `_encode_prompt()` is deprecated and it will be removed in a future version. Use `encode_prompt()` instead. Also, be aware that the output format changed from a concatenated tensor to a tuple.
  deprecate("_encode_prompt()", "1.0.0", deprecation_message, standard_warn=False)
Token indices sequence length is longer than the specified maximum sequence length for this model (112 > 77). Running this sequence through the model will result in indexing errors
The following part of your input was truncated because CLIP can only handle sequences up to 77 tokens: ['james gilleard, surrealism, airbrush, ilya kuvshinov, wlop, stanley artgerm, very coherent, art by takato yamamoto and james jean']
mse_0.0009443090024031728_ssim_0.9373271232158672
000: Detection: True; Decoding: True; Combined: True

  0%|          | 0/50 [00:00<?, ?it/s][A
  2%|▏         | 1/50 [00:00<00:11,  4.39it/s][A
  4%|▍         | 2/50 [00:00<00:10,  4.39it/s][A
  6%|▌         | 3/50 [00:00<00:10,  4.39it/s][A
  8%|▊         | 4/50 [00:00<00:10,  4.39it/s][A
 10%|█         | 5/50 [00:01<00:10,  4.39it/s][A
 12%|█▏        | 6/50 [00:01<00:10,  4.40it/s][A
 14%|█▍        | 7/50 [00:01<00:09,  4.39it/s][A
 16%|█▌        | 8/50 [00:01<00:09,  4.39it/s][A
 18%|█▊        | 9/50 [00:02<00:09,  4.39it/s][A
 20%|██        | 10/50 [00:02<00:09,  4.39it/s][A
 22%|██▏       | 11/50 [00:02<00:08,  4.39it/s][A
 24%|██▍       | 12/50 [00:02<00:08,  4.39it/s][A
 26%|██▌       | 13/50 [00:02<00:08,  4.39it/s][A
 28%|██▊       | 14/50 [00:03<00:08,  4.39it/s][A
 30%|███       | 15/50 [00:03<00:07,  4.39it/s][A
 32%|███▏      | 16/50 [00:03<00:07,  4.39it/s][A
 34%|███▍      | 17/50 [00:03<00:07,  4.39it/s][A
 36%|███▌      | 18/50 [00:04<00:07,  4.39it/s][A
 38%|███▊      | 19/50 [00:04<00:07,  4.39it/s][A
 40%|████      | 20/50 [00:04<00:06,  4.39it/s][A
 42%|████▏     | 21/50 [00:04<00:06,  4.39it/s][A
 44%|████▍     | 22/50 [00:05<00:06,  4.39it/s][A
 46%|████▌     | 23/50 [00:05<00:06,  4.39it/s][A
 48%|████▊     | 24/50 [00:05<00:05,  4.39it/s][A
 50%|█████     | 25/50 [00:05<00:05,  4.39it/s][A
 52%|█████▏    | 26/50 [00:05<00:05,  4.39it/s][A
 54%|█████▍    | 27/50 [00:06<00:05,  4.38it/s][A
 56%|█████▌    | 28/50 [00:06<00:05,  4.38it/s][A
 58%|█████▊    | 29/50 [00:06<00:04,  4.39it/s][A
 60%|██████    | 30/50 [00:06<00:04,  4.39it/s][A
 62%|██████▏   | 31/50 [00:07<00:04,  4.39it/s][A
 64%|██████▍   | 32/50 [00:07<00:04,  4.39it/s][A
 66%|██████▌   | 33/50 [00:07<00:03,  4.39it/s][A
 68%|██████▊   | 34/50 [00:07<00:03,  4.39it/s][A
 70%|███████   | 35/50 [00:07<00:03,  4.39it/s][A
 72%|███████▏  | 36/50 [00:08<00:03,  4.39it/s][A
 74%|███████▍  | 37/50 [00:08<00:02,  4.39it/s][A
 76%|███████▌  | 38/50 [00:08<00:02,  4.39it/s][A
 78%|███████▊  | 39/50 [00:08<00:02,  4.39it/s][A
 80%|████████  | 40/50 [00:09<00:02,  4.39it/s][A
 82%|████████▏ | 41/50 [00:09<00:02,  4.39it/s][A
 84%|████████▍ | 42/50 [00:09<00:01,  4.39it/s][A
 86%|████████▌ | 43/50 [00:09<00:01,  4.39it/s][A
 88%|████████▊ | 44/50 [00:10<00:01,  4.39it/s][A
 90%|█████████ | 45/50 [00:10<00:01,  4.39it/s][A
 92%|█████████▏| 46/50 [00:10<00:00,  4.39it/s][A
 94%|█████████▍| 47/50 [00:10<00:00,  4.38it/s][A
 96%|█████████▌| 48/50 [00:10<00:00,  4.38it/s][A
 98%|█████████▊| 49/50 [00:11<00:00,  4.38it/s][A
100%|██████████| 50/50 [00:11<00:00,  4.38it/s][A100%|██████████| 50/50 [00:11<00:00,  4.39it/s]
/home/dezhang/.local/lib/python3.10/site-packages/diffusers/pipelines/stable_diffusion/pipeline_stable_diffusion.py:430: FutureWarning: The decode_latents method is deprecated and will be removed in 1.0.0. Please use VaeImageProcessor.postprocess(...) instead
  deprecate("decode_latents", "1.0.0", deprecation_message, standard_warn=False)
The following part of your input was truncated because CLIP can only handle sequences up to 77 tokens: ['james gilleard, surrealism, airbrush, ilya kuvshinov, wlop, stanley artgerm, very coherent, art by takato yamamoto and james jean']
tensor(0., device='cuda:1', dtype=torch.float64)
tensor(4.0278, device='cuda:1', dtype=torch.float64)

  0%|          | 0/50 [00:00<?, ?it/s][A
  2%|▏         | 1/50 [00:00<00:11,  4.38it/s][A
  4%|▍         | 2/50 [00:00<00:10,  4.39it/s][A
  6%|▌         | 3/50 [00:00<00:10,  4.39it/s][A
  8%|▊         | 4/50 [00:00<00:10,  4.39it/s][A
 10%|█         | 5/50 [00:01<00:10,  4.39it/s][A
 12%|█▏        | 6/50 [00:01<00:10,  4.39it/s][A
 14%|█▍        | 7/50 [00:01<00:09,  4.39it/s][A
 16%|█▌        | 8/50 [00:01<00:09,  4.39it/s][A
 18%|█▊        | 9/50 [00:02<00:09,  4.39it/s][A
 20%|██        | 10/50 [00:02<00:09,  4.39it/s][A
 22%|██▏       | 11/50 [00:02<00:08,  4.38it/s][A
 24%|██▍       | 12/50 [00:02<00:08,  4.38it/s][A
 26%|██▌       | 13/50 [00:02<00:08,  4.38it/s][A
 28%|██▊       | 14/50 [00:03<00:08,  4.38it/s][A
 30%|███       | 15/50 [00:03<00:07,  4.38it/s][A
 32%|███▏      | 16/50 [00:03<00:07,  4.38it/s][A
 34%|███▍      | 17/50 [00:03<00:07,  4.38it/s][A
 36%|███▌      | 18/50 [00:04<00:07,  4.38it/s][A
 38%|███▊      | 19/50 [00:04<00:07,  4.39it/s][A
 40%|████      | 20/50 [00:04<00:06,  4.38it/s][A
 42%|████▏     | 21/50 [00:04<00:06,  4.38it/s][A
 44%|████▍     | 22/50 [00:05<00:06,  4.39it/s][A
 46%|████▌     | 23/50 [00:05<00:06,  4.39it/s][A
 48%|████▊     | 24/50 [00:05<00:05,  4.39it/s][A
 50%|█████     | 25/50 [00:05<00:05,  4.39it/s][A
 52%|█████▏    | 26/50 [00:05<00:05,  4.39it/s][A
 54%|█████▍    | 27/50 [00:06<00:05,  4.39it/s][A
 56%|█████▌    | 28/50 [00:06<00:05,  4.39it/s][A
 58%|█████▊    | 29/50 [00:06<00:04,  4.39it/s][A
 60%|██████    | 30/50 [00:06<00:04,  4.39it/s][A
 62%|██████▏   | 31/50 [00:07<00:04,  4.39it/s][A
 64%|██████▍   | 32/50 [00:07<00:04,  4.39it/s][A
 66%|██████▌   | 33/50 [00:07<00:03,  4.38it/s][A
 68%|██████▊   | 34/50 [00:07<00:03,  4.38it/s][A
 70%|███████   | 35/50 [00:07<00:03,  4.39it/s][A
 72%|███████▏  | 36/50 [00:08<00:03,  4.38it/s][A
 74%|███████▍  | 37/50 [00:08<00:02,  4.38it/s][A
 76%|███████▌  | 38/50 [00:08<00:02,  4.38it/s][A
 78%|███████▊  | 39/50 [00:08<00:02,  4.38it/s][A
 80%|████████  | 40/50 [00:09<00:02,  4.38it/s][A
 82%|████████▏ | 41/50 [00:09<00:02,  4.39it/s][A
 84%|████████▍ | 42/50 [00:09<00:01,  4.39it/s][A
 86%|████████▌ | 43/50 [00:09<00:01,  4.39it/s][A
 88%|████████▊ | 44/50 [00:10<00:01,  4.39it/s][A
 90%|█████████ | 45/50 [00:10<00:01,  4.38it/s][A
 92%|█████████▏| 46/50 [00:10<00:00,  4.39it/s][A
 94%|█████████▍| 47/50 [00:10<00:00,  4.39it/s][A
 96%|█████████▌| 48/50 [00:10<00:00,  4.38it/s][A
 98%|█████████▊| 49/50 [00:11<00:00,  4.38it/s][A
100%|██████████| 50/50 [00:11<00:00,  4.38it/s][A100%|██████████| 50/50 [00:11<00:00,  4.39it/s]
